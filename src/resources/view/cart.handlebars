<!-- resources/view/cart.hbs -->
<body>
    <!-- Main Content -->
    <main class="my-5">
        <div class="container full-width-container">
            <div class="row">
                <!-- Left Column - Order Information -->
                <div class="col-md-7 p-4 bg-white">
                    <h2 class="mb-4">Thông tin đặt hàng</h2>

                    <!-- Personal Information -->
                    <div class="mb-4">
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="prefix" class="form-label">Họ và tên</label>
                                <select class="form-select" id="prefix">
                                    <option value="ANH/ÔN">ANH/ÔNG</option>
                                    <option value="CHỊ/BÀ">CHỊ/BÀ</option>
                                </select>
                            </div>
                            <div class="col-md-8">
                                <label class="form-label"> </label>
                                <input type="text" class="form-control" id="fullName" placeholder="Nhập họ tên của bạn">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="phone" class="form-label">Số điện thoại</label>
                            <input type="tel" class="form-control" id="phone" placeholder="Nhập số điện thoại của bạn">
                        </div>

                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email"
                                placeholder="Thêm địa chỉ email để được gửi xác nhận đơn hàng và CTKM">
                        </div>
                    </div>

                    <!-- Address Information -->
                    <div class="mb-4">
                        <div class="mb-3">
                            <label for="address" class="form-label">Địa chỉ chi tiết</label>
                            <input type="text" class="form-control" id="address"
                                placeholder="Địa chỉ (ví dụ: 103 Văn Phúc, phường Văn Phúc)">
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="city" class="form-label">Tỉnh/Thành phố</label>
                                <select class="form-select" id="city">
                                    <option value="">Chọn Tỉnh/Thành phố</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="district" class="form-label">Quận/Huyện</label>
                                <select class="form-select" id="district">
                                    <option value="">Chọn Quận/Huyện</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="ward" class="form-label">Phường/Xã</label>
                                <select class="form-select" id="ward">
                                    <option value="">Chọn Phường/Xã</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="note" class="form-label">Ghi chú</label>
                            <textarea class="form-control" id="note" rows="3"
                                placeholder="Ghi chú thêm (Ví dụ: Giao hàng giờ hành chính)"></textarea>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="giftOption">
                            <label class="form-check-label" for="giftOption">Gói cho người thân (Miễn phí gói quà)</label>
                        </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="mb-4">
                        <h2 class="mb-3">Hình thức thanh toán</h2>

                        <div class="payment-methods">
                            <div class="form-check payment-option border p-3 rounded mb-2">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="codPayment" checked>
                                <label class="form-check-label d-flex align-items-center" for="codPayment">
                                    <img src="/img/payment/cod.png" alt="COD" class="me-2" height="30">
                                    <span>Thanh toán khi nhận hàng</span>
                                </label>
                            </div>

                            <div class="form-check payment-option border p-3 rounded mb-2">
                                {{!-- <input class="form-check-input" type="radio" name="paymentMethod" id="momoPayment"> --}}
                                <label class="form-check-label d-flex align-items-center" for="momoPayment">
                                    <img src="/img/payment/momo.png" alt="MoMo" class="me-2" height="30">
                                    <span>Ví MoMo</span>
                                </label>
                            </div>

                            <div class="form-check payment-option border p-3 rounded mb-2">
                                {{!-- <input class="form-check-input" type="radio" name="paymentMethod" id="zaloPayment"> --}}
                                <label class="form-check-label d-flex align-items-center" for="zaloPayment">
                                    <img src="/img/payment/zalopay.png" alt="ZaloPay" class="me-2" height="30">
                                    <span>Thanh toán qua ZaloPay</span>
                                </label>
                            </div>

                            <div class="form-check payment-option border p-3 rounded mb-2">
                                {{!-- <input class="" type="radio" name="paymentMethod" id="vnpayPayment"> --}}
                                <label class="form-check-label d-flex align-items-center" for="vnpayPayment">
                                    <img src="/img/payment/vnpay.png" alt="VNPAY" class="me-2" height="30">
                                    <span>Ví điện tử VNPAY</span>
                                </label>
                            </div>
                        </div>

                        <div class="mt-3 small text-muted">
                            <p>Nếu bạn không hài lòng với sản phẩm của chúng tôi? Bạn hoàn toàn có thể trả lại sản phẩm. 
                                <a href="#" class="text-primary">Tìm hiểu thêm tại đây</a>.</p>
                        </div>
                    </div>

                    <div class="mb-4 d-md-none">
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary btn-lg checkout-button" type="button">ĐẶT HÀNG</button>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Cart Summary -->
                <div class="col-md-5 p-4 bg-white">
                    <div class="card">
                        <div class="card-body">
                            <h2 class="mb-4">Giỏ hàng</h2>

                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span>TẤT CẢ SẢN PHẨM</span>
                                <button class="btn btn-outline-danger btn-sm" id="clearCartButton">XÓA TẤT CẢ</button>
                            </div>

                            <!-- Cart Items -->
                            <div id="cartItems" class="cart-items mb-4">
                                {{#if cartItems.length}}
                                    {{#each cartItems}}
                                        <div class="card mb-3 cart-item" data-id="{{cart_id}}">
                                            <div class="row g-0 h-100">
                                                <div class="col-md-2 d-flex align-items-center">
                                                    <div class="cart-item-image-container h-100 d-flex align-items-center">
                                                        <img src="{{variant_image}}" class="img-fluid rounded-start" alt="{{product_name}}" style="width: 80px; object-fit: contain;">
                                                    </div>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="card-body h-100 d-flex flex-column justify-content-between">
                                                        <div>
                                                            <div class="d-flex justify-content-between">
                                                                <h5 class="card-title">{{product_name}}</h5>
                                                                <button type="button" class="btn-close" onclick="removeItem('{{cart_id}}')"></button>
                                                            </div>
                                                            <p class="card-text mb-1">Màu: {{lookup ../colorNameMap color_id}} | Kích thước: {{size_id}}</p>
                                                            <p class="card-text text-primary mb-2">{{helpers.formatCurrency price}}</p>
                                                        </div>
                                                        <div class="d-flex align-items-center">
                                                            <div class="input-group input-group-sm" style="width: 120px;">
                                                                <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity('{{cart_id}}')">-</button>
                                                                <input type="text" class="form-control text-center" value="{{quantity}}" readonly>
                                                                <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity('{{cart_id}}')">+</button>
                                                            </div>
                                                            <div class="ms-3">
                                                                <span class="fw-bold">{{helpers.formatCurrency (multiply price quantity)}}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {{/each}}
                                {{else}}
                                    <div class="text-center py-4">
                                        <p>Giỏ hàng của bạn đang trống</p>
                                        <a href="/homepage" class="btn btn-outline-primary">Tiếp tục mua sắm</a>
                                    </div>
                                {{/if}}
                            </div>

                            <!-- Order Summary -->
                            <div class="order-summary mb-4">
                                <div class="d-flex justify-content-between mb-2">
                                    <div>Tạm tính</div>
                                    <div class="fw-bold" id="subtotal">{{helpers.formatCurrency totalAmount}}</div>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <div>Giảm giá</div>
                                    <div>{{helpers.formatCurrency discount}}</div>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <div>Phí giao hàng</div>
                                    <div class="fw-bold" id="shipping">{{helpers.formatCurrency shippingFee}}</div>
                                </div>
                                <hr>
                                <div class="d-flex justify-content-between">
                                    <div class="fw-bold">Tổng</div>
                                    <div class="fw-bold fs-5" id="total">{{helpers.formatCurrency finalTotal}}</div>
                                </div>
                                <div class="text-end text-muted small">
                                    <span id="vatAmount">(Đã gồm {{helpers.formatCurrency vatAmount}} tiền VAT)</span>
                                </div>
                            </div>

                            <!-- CTA Button -->
                            <div class="d-none d-md-block">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary btn-lg checkout-button" type="button">ĐẶT HÀNG</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <link rel="stylesheet" href="/css/cart.css">
    <script src="/js/cart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>